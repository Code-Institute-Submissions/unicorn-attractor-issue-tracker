{% extends 'base.html' %}

{% block page.title %}Issues Page{% endblock %}

{% block page.heading %}Issues{% endblock %}

{% block content %}
<main class="container content">
    <section class="row issues">
        <section class="col-sm-12 buttons">
            {% if user.is_authenticated and user.profile %}
                <section class="create-issue-button">
                    <a href="{% url 'create_issue' %}"><span>Create issue</span></a>
                </section>
            {% else %}
                <p><a href="{% url 'register' %}" class="register-link"><span>Register to start creating issues</span></a></p>
            {% endif %}
        </section>
        {% for issue in issues %}
        <section class="col-sm-12 issue">
            <article>
                <section class="issue-top-info">
                    <section>
                        {% if issue.issue_type == 'BG' %}
                            <i class="fas fa-bug" title="Bug"></i>
                        {% else %}
                            <i class="far fa-lightbulb" title="Feature"></i>
                        {% endif %}
                        <p class="status ic">{{ issue.status_long }}</p>
                        {% if user.is_authenticated and user == issue.author %}
                            <i class="fas fa-trash-alt" title="Delete"></i>
                        {% endif %}
                    </section>
                    <p class="upvotes-count"><i class="fas fa-level-up-alt" title="Upvote"></i></i> {{ issue.total_upvotes }}</p>
                </section>
                <section class="issue-bottom-info">
                    <a href="{% url 'issue_details' issue.id %}" class="title"><p>{{ issue.title }}</p></a>
                    <section class="dates">
                        <p>Created on {{ issue.created|date:"M j Y" }} by <strong>{{ issue.author.username }}</strong></p>
                        {% if issue.created %}
                        <p>Updated on {{ issue.created|date:"M j Y" }}</p>
                        {% endif %}
                    </section>
                </section>
            </article>
        </section>
        {% endfor %}
    </section>
</main>
{% endblock %}
